<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50">
  <!-- Cabeçalho do Relatório -->
  <div class="bg-white shadow-xl border-b border-gray-100 relative overflow-hidden">
    <!-- Background Pattern -->
    <div class="absolute inset-0 bg-gradient-to-r from-blue-600/5 to-indigo-600/5"></div>
    <div class="absolute top-0 right-0 w-64 h-64 bg-gradient-to-bl from-blue-100/30 to-transparent rounded-full -translate-y-32 translate-x-32"></div>
    
    <div class="max-w-6xl mx-auto px-6 py-12 relative">
      <!-- Logo e Nome do Laboratório -->
      <div class="flex items-center justify-between mb-8">
        <div class="flex items-center">
          <!-- Logo Modernizado -->
          <div class="w-20 h-20 bg-gradient-to-br from-orange-400 to-orange-600 rounded-2xl flex items-center justify-center mr-6 shadow-lg transform rotate-3 hover:rotate-0 transition-transform duration-300">
            <span class="text-white font-bold text-xl">LAB</span>
          </div>
          <div>
            <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">Laboratório Escola</h1>
            <p class="text-gray-600 text-lg font-medium tracking-wide">ANÁLISES CLÍNICAS</p>
            <div class="w-16 h-1 bg-gradient-to-r from-orange-400 to-orange-600 rounded-full mt-2"></div>
          </div>
        </div>
        
        <!-- Informações do Atendimento -->
        <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-gray-100">
          <div class="grid grid-cols-1 gap-3 text-sm">
            <div class="flex justify-between items-center">
              <span class="text-gray-600 font-medium">O.S.:</span>
              <span class="font-bold text-gray-900 font-mono"><%= @numero_os %></span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-gray-600 font-medium">Data:</span>
              <span class="font-semibold text-gray-900"><%= Date.current.strftime('%d/%m/%Y') %></span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-gray-600 font-medium">Paciente:</span>
              <span class="font-bold text-blue-600"><%= @paciente.nome.upcase %></span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-gray-600 font-medium">Idade:</span>
              <span class="font-semibold text-gray-900"><%= @paciente.idade %> anos</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-gray-600 font-medium">Sexo:</span>
              <span class="font-semibold text-gray-900"><%= @paciente.sexo == 'M' ? 'Masculino' : 'Feminino' %></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Conteúdo do Relatório -->
  <div class="max-w-4xl mx-auto px-6 py-8">
    <!-- Botões de Ação -->
    <div class="mb-12 flex flex-col items-center justify-center print:hidden">
      <div class="flex space-x-4">
        <%= link_to preview_pdf_path(@paciente), class: "group inline-flex items-center px-8 py-4 border border-transparent text-base font-medium rounded-2xl text-white bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200", target: "_blank" do %>
          <svg class="w-5 h-5 mr-3 group-hover:animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
          </svg>
          Pré-visualizar PDF
        <% end %>

        <%= link_to exame_pacientes_path, class: "group inline-flex items-center px-8 py-4 border border-gray-300 text-base font-medium rounded-2xl text-gray-700 bg-white hover:bg-gray-50 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200" do %>
          <svg class="w-5 h-5 mr-3 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
          </svg>
          Voltar
        <% end %>
      </div>

      <div class="mt-6 py-6 px-30 bg-green-100 border border-green-600 rounded-xl shadow-lg flex items-center justify-center flex-col gap-3">
          <div class="flex items-center gap-2">
            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 1010 10A10 10 0 0012 2z" />
            </svg>
            <span class="text-xl text-green-600">Confirme a emissão do exame</span>
          </div>
          <div>
            <%=button_to "Confirmar", confirmar_emissao_path(@paciente.id), method: :post, class:"bg-gradient-to-r from-green-500 to-green-600 text-white py-2 px-3 rounded shadow text-xl cursor-pointer hover:shadow-xl transform hover:scale-105 transition-all duration-200"%>
          </div>
      </div>

    </div>

    <!-- Resultados dos Exames -->
    <% @exames.each do |exame_paciente| %>
      <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden mb-8">
        <div class="bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-4">
          <h2 class="text-xl font-bold text-white">
            <%= exame_paciente.exame.nome.upcase %>
          </h2>
        </div>

        <div class="p-6">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
            <div class="font-medium">Resultado:</div>
            <div class="text-right font-semibold"><%= exame_paciente.resultado || "Normal" %></div>
            <% 
              situacao_relatorio = exame_paciente.situacao_resultado
              if situacao_relatorio == :normal
                situacao_texto = 'Dentro do esperado'
                situacao_cor = 'text-green-600'
              elsif situacao_relatorio == :acima
                situacao_texto = 'Acima do esperado'
                situacao_cor = 'text-red-600'
              elsif situacao_relatorio == :abaixo
                situacao_texto = 'Abaixo do esperado'
                situacao_cor = 'text-yellow-600'
              else
                situacao_texto = 'Indefinido'
                situacao_cor = 'text-gray-600'
              end
            %>
            <div class="<%= situacao_cor %> font-medium"><%= situacao_texto %></div>
          </div>
          
          <% if exame_paciente.data_exame.present? %>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mt-2">
              <div class="font-medium">Data do Exame:</div>
              <div class="text-right"><%= exame_paciente.data_exame.strftime('%d/%m/%Y') %></div>
              <div></div>
            </div>
          <% end %>
          
          <% if exame_paciente.observacoes.present? %>
            <div class="mt-4 p-3 bg-yellow-50 border-l-4 border-yellow-400">
              <p class="text-sm"><strong>Observações:</strong> <%= exame_paciente.observacoes %></p>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Rodapé -->
    <div class="mt-12 pt-6 border-t border-gray-200 text-xs text-gray-500">
      <p>* Relatório gerado automaticamente em <%= Time.current.strftime('%d/%m/%Y às %H:%M') %></p>
      <p>* Sistema Laboratório Escola - Análises Clínicas</p>
    </div>
  </div>
</div>

<style>
@media print {
  .print\\:hidden { display: none !important; }
  body { font-size: 12px; }
  .shadow-sm { box-shadow: none !important; }
}
</style>
